<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><meta name=format-detection content="telephone=no"><meta name=theme-color content="#a6d6d6"><meta name=referrer content="no-referrer"><meta name=description content="Windows 的计划任务功能不够用，于是试着写了个支持插件和动态加载的定时执行任务工具 Qzzz，暂时是个坑&mldr;
Qzzz A scheduler app for windows.
How to use  Run as a windows service
Use Install.bat to install the QzzzService Run as a console
Run Qzzz.exe and do not close the console.  Create a plugin   create a config file qzzz.json
{ &#34;Id&#34;: &#34;323ADBF530C4307B336C670B3F5BD229&#34;, &#34;Name&#34;: &#34;ToastPluginDemo&#34;, &#34;Version&#34;: &#34;1.0&#34;, &#34;Description&#34;: &#34;Toast plugin demo&#34;, &#34;CronExpression&#34;: &#34;*/15 * * * * ?&#34;, &#34;StartAt&#34;: &#34;2014-06-01 00:00:00&#34;, &#34;EndAt&#34;: &#34;2014-07-01 00:01:00&#34;, &#34;PluginFileName&#34;: &#34;Qzzz."><meta name=author content="caoyue"><title>且听疯吟 / Qzzz</title><link rel=alternate type=application/rss+xml href=/index.xml title=且听疯吟><link rel=apple-touch-icon sizes=192x192 href=https://blog.caoyue.me/favicon.png><link rel=icon type=image/png sizes=48x48 href=https://blog.caoyue.me/favicon.png><link rel=icon type=image/png sizes=192x192 href=https://blog.caoyue.me/favicon.png><link rel=stylesheet type=text/css href=https://blog.caoyue.me/normalize.css><link rel=stylesheet type=text/css href=https://blog.caoyue.me/scss/style.css><link rel=stylesheet type=text/css href=https://blog.caoyue.me/syntax/monokailight.css id=syntax-theme><script type=text/javascript>function syntaxHighlight(){var e=document.querySelector("#syntax-theme");let t="https://blog.caoyue.me/syntax/monokailight.css",n="https://blog.caoyue.me/syntax/dracula.css",s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?n:t;e.href=s}syntaxHighlight(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{syntaxHighlight()})</script><script src=https://kit.fontawesome.com/061cfdc036.js crossorigin=anonymous></script></head><body><div class=wrap><header class=header><a href=/ title=且听疯吟>且听疯吟</a>
<span>如此生活三十年</span></header><div class=left><ul class=list><li><a href=/ title=Home>Home</a></li><li><a href=/tweets title=碎碎念>Tweets</a></li><li><a href=/archives title=Archives>Archives</a></li><li><a href=/tags title=Tags>Tags</a></li></ul></div><div class=right><div class=entry id=cotent><div class=title>Qzzz</div><div class=content><p>Windows 的计划任务功能不够用，于是试着写了个支持插件和动态加载的定时执行任务工具 <a href=https://github.com/caoyue/Qzzz>Qzzz</a>，暂时是个坑&mldr;</p><h1 id=qzzz>Qzzz</h1><p>A scheduler app for windows.</p><h3 id=how-to-use>How to use</h3><ul><li><strong>Run as a windows service</strong><br><br>Use <code>Install.bat</code> to install the <code>QzzzService</code></li><li><strong>Run as a console</strong><br><br>Run <code>Qzzz.exe</code> and do not close the console.</li></ul><h3 id=create-a-plugin>Create a plugin</h3><ul><li><p>create a config file <code>qzzz.json</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Id&#34;</span><span class=p>:</span> <span class=s2>&#34;323ADBF530C4307B336C670B3F5BD229&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Name&#34;</span><span class=p>:</span> <span class=s2>&#34;ToastPluginDemo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Description&#34;</span><span class=p>:</span> <span class=s2>&#34;Toast plugin demo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;CronExpression&#34;</span><span class=p>:</span> <span class=s2>&#34;*/15 * * * * ?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;StartAt&#34;</span><span class=p>:</span> <span class=s2>&#34;2014-06-01 00:00:00&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;EndAt&#34;</span><span class=p>:</span> <span class=s2>&#34;2014-07-01 00:01:00&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;PluginFileName&#34;</span><span class=p>:</span> <span class=s2>&#34;Qzzz.ToastPluginDemo.dll&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;caoyue&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/caoyue/Qzzz&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><code>Id</code> should be a guid string</li><li><code>CronExpression</code> is a Quartz Cron Expression, a little different from *nix</li><li><code>StartAt</code> and <code>EndAt</code> is optional</li></ul></li><li><p>Create a CSharp library project</p></li><li><p>Add <code>Qzzz.Plugin.dll</code> to the references</p></li><li><p>Implement <code>IPlugin</code> interface</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-CSharp data-lang=CSharp><span class=line><span class=cl><span class=k>public</span> <span class=k>class</span> <span class=nc>SimplePlugin</span> <span class=p>:</span> <span class=n>IPlugin</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>void</span> <span class=n>Execute</span><span class=p>(</span><span class=n>PluginContext</span> <span class=n>pluginContext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// do your job here...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=kt>bool</span> <span class=n>Pause</span><span class=p>(</span><span class=n>PluginContext</span> <span class=n>pluginContext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// pause job while the return is true...</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>You can find a demo in <code>Plugins\Qzzz.SimplePluginDemo</code></li><li>Add <code>Qzzz.Toast.dll</code> to use toast notification on windows 8/8.1, like <code>Plugins\Qzzz.ToastPluginDemo</code></li></ul></li><li><p>Build your project and copy the plugin folder to <code>Qzzz\Plugins</code></p></li></ul></div><div class=tags><ul class=info><li>2014-06-28</li><li><a href=https://blog.caoyue.me/tags/project>#project</a></li><li><a href=https://blog.caoyue.me/tags/csharp>#csharp</a></li><li class=button title="show comments" id=toggle-comments><i class="fa-solid fa-message"></i></li></ul></div></div><div class=comments id=comments><section class="article discussion" style=display:none><script>function loadComment(){let t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"photon-dark":"github-light",e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","caoyue/caoyue.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme",t),e.setAttribute("label","Comment"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",''),document.querySelector("section.article.discussion").innerHTML='',document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()});function toggleComment(){let e=document.querySelector("section.article.discussion");e.style.display=="none"?e.style.display="block":e.style.display="none"}document.querySelector("#toggle-comments").addEventListener("click",toggleComment)</script></section></div></div><footer class=footer><div>©2022 <a href=/>且听疯吟</a>. designed
by <a href=https://caoyue.me target=_blank>caoyue</a>.
powered by <a href=https://gohugo.io/ target=_blank>hugo</a>.
<script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "1a24e73fd4284bfa8b43ecf5a5c2c100"}'></script>
<script defer src=https://use.typekit.net/jdb5cpn.js></script>
<script type=text/javascript>try{Typekit.load({async:!0})}catch(e){}</script></div></footer></div></body></html>