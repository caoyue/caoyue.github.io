<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="default"><meta name=format-detection content="telephone=no"><meta name=theme-color content="#a6d6d6"><meta name=referrer content="no-referrer"><meta name=description content="6. 编译并运行程序  （略）  7. 并发  机制  Erlang 程序由成百上千个 Process 组成，这些 Process 之间可以互发消息 Process 能否接收到或者理解消息是不确定的，要知道结果必须向该 Process 发送消息询问并等待 Process 之间可以互相 Link ，当 Process 消亡时与之相连的 Process 会收到消息    8. 并发编程   并发原语
 Pid = spawn(Module, FuncName, Args)
创建一个新的 Process，用于对 Func 求值，并返回该 Process 的 pid Pid ! Message  向指定 Pid 的 Process 发送消息，返回值为 Message 本身 消息发送是异步的，无需等待即可进行其他操作   receive ... end  接收一个发给当前进程的消息   self()"><meta name=author content="caoyue"><title>且听疯吟 / Erlang Programming 笔记 3</title><link rel=alternate type=application/rss+xml href=/index.xml title=且听疯吟><link rel=apple-touch-icon sizes=192x192 href=https://blog.caoyue.me/favicon.png><link rel=icon type=image/png sizes=48x48 href=https://blog.caoyue.me/favicon.png><link rel=icon type=image/png sizes=192x192 href=https://blog.caoyue.me/favicon.png><link rel=stylesheet type=text/css href=https://blog.caoyue.me/normalize.css><link rel=stylesheet type=text/css href=https://blog.caoyue.me/scss/style.css><link rel=stylesheet type=text/css href=https://blog.caoyue.me/syntax/monokailight.css id=syntax-theme><script type=text/javascript>function syntaxHighlight(){var e=document.querySelector("#syntax-theme");let t="https://blog.caoyue.me/syntax/monokailight.css",n="https://blog.caoyue.me/syntax/dracula.css",s=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?n:t;e.href=s}syntaxHighlight(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{syntaxHighlight()})</script><script src=https://kit.fontawesome.com/061cfdc036.js crossorigin=anonymous></script></head><body><div class=wrap><header class=header><a href=/ title=且听疯吟>且听疯吟</a>
<span>如此生活三十年</span></header><div class=left><ul class=list><li><a href=/ title=Home>Home</a></li><li><a href=/tweets title=碎碎念>Tweets</a></li><li><a href=/archives title=Archives>Archives</a></li><li><a href=/tags title=Tags>Tags</a></li></ul></div><div class=right><div class=entry id=cotent><div class=title>Erlang Programming 笔记 3</div><div class=content><h3 id=6-编译并运行程序>6. 编译并运行程序</h3><ul><li>（略）</li></ul><h3 id=7-并发>7. 并发</h3><ul><li>机制<ul><li>Erlang 程序由成百上千个 Process 组成，这些 Process 之间可以互发消息</li><li>Process 能否接收到或者理解消息是不确定的，要知道结果必须向该 Process 发送消息询问并等待</li><li>Process 之间可以互相 Link ，当 Process 消亡时与之相连的 Process 会收到消息</li></ul></li></ul><h3 id=8-并发编程>8. 并发编程</h3><ul><li><p>并发原语</p><ul><li><code>Pid = spawn(Module, FuncName, Args)</code><br>创建一个新的 Process，用于对 Func 求值，并返回该 Process 的 pid</li><li><code>Pid ! Message</code><ul><li>向指定 Pid 的 Process 发送消息，返回值为 Message 本身</li><li>消息发送是异步的，无需等待即可进行其他操作</li></ul></li><li><code>receive ... end</code><ul><li>接收一个发给当前进程的消息</li></ul></li><li><code>self()</code><br>获取自己的 pid</li></ul></li><li><p>注册进程</p><ul><li><code>register(AnAtom, Pid)</code></li><li><code>unregiseter(AnAtom)</code><br>进程死亡时会自动 unregiseter</li></ul></li><li><p>编写并发程序的一般模式</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-erlang data-lang=erlang><span class=line><span class=cl><span class=p>-</span><span class=ni>module</span> <span class=p>(</span><span class=n>concurrency</span><span class=p>).</span>
</span></span><span class=line><span class=cl><span class=p>-</span><span class=ni>compile</span><span class=p>(</span><span class=n>export_all</span><span class=p>).</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>start</span><span class=p>()</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nb>spawn</span><span class=p>(</span><span class=o>?</span><span class=nv>MODULE</span><span class=p>,</span> <span class=n>loop</span><span class=p>,</span> <span class=p>[]).</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>rpc</span><span class=p>(</span><span class=nv>Pid</span><span class=p>,</span> <span class=nv>Request</span><span class=p>)</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nv>Pid</span> <span class=o>!</span> <span class=p>{</span><span class=n>self</span><span class=p>(),</span> <span class=nv>Request</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=k>receive</span>
</span></span><span class=line><span class=cl>         <span class=p>{</span><span class=nv>Pid</span><span class=p>,</span> <span class=nv>Response</span><span class=p>}</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>             <span class=p>{</span><span class=nv>Pid</span><span class=p>,</span> <span class=nv>Response</span><span class=p>}</span>
</span></span><span class=line><span class=cl>     <span class=k>end</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>loop</span><span class=p>(</span><span class=nv>X</span><span class=p>)</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>receive</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nv>From</span><span class=p>,</span> <span class=nv>Any</span><span class=p>}</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nv>From</span> <span class=o>!</span> <span class=p>{</span><span class=n>self</span><span class=p>(),</span> <span class=s>&#34;Received!&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nn>io</span><span class=p>:</span><span class=nf>format</span><span class=p>(</span><span class=s>&#34;Received: </span><span class=si>~p~n</span><span class=s>&#34;</span><span class=p>,</span> <span class=p>[</span><span class=nv>Any</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=n>loop</span><span class=p>(</span><span class=nv>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span><span class=p>.</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-erlang data-lang=erlang><span class=line><span class=cl><span class=c>%% run in erlang shell
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nv>Pid</span> <span class=o>=</span> <span class=nn>concurrency</span><span class=p>:</span><span class=nf>start</span><span class=p>().</span>
</span></span><span class=line><span class=cl><span class=c>%% &lt;0.33.0&gt;
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nn>concurrency</span><span class=p>:</span><span class=nf>rpc</span><span class=p>(</span><span class=nv>Pid</span><span class=p>,</span> <span class=s>&#34;test！&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c>%% Received: &#34;test&#34;
</span></span></span><span class=line><span class=cl><span class=c>%% {&lt;0.56.0&gt;,&#34;Received!&#34;}
</span></span></span></code></pre></div></li></ul></div><div class=tags><ul class=info><li>2015-04-23</li><li><a href=https://blog.caoyue.me/tags/erlang>#erlang</a></li><li class=button title="show comments" id=toggle-comments><i class="fa-solid fa-message"></i></li></ul></div></div><div class=comments id=comments><section class="article discussion" style=display:none><script>function loadComment(){let t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"photon-dark":"github-light",e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","caoyue/caoyue.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme",t),e.setAttribute("label","Comment"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",''),document.querySelector("section.article.discussion").innerHTML='',document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()});function toggleComment(){let e=document.querySelector("section.article.discussion");e.style.display=="none"?e.style.display="block":e.style.display="none"}document.querySelector("#toggle-comments").addEventListener("click",toggleComment)</script></section></div></div><footer class=footer><div>©2022 <a href=/>且听疯吟</a>. designed
by <a href=https://caoyue.me target=_blank>caoyue</a>.
powered by <a href=https://gohugo.io/ target=_blank>hugo</a>.
<script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "1a24e73fd4284bfa8b43ecf5a5c2c100"}'></script>
<script defer src=https://use.typekit.net/jdb5cpn.js></script>
<script type=text/javascript>try{Typekit.load({async:!0})}catch(e){}</script></div></footer></div></body></html>